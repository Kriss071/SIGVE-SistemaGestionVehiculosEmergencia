<nav class="navbar navbar-expand-lg navbar-dark shadow-sm sticky-top
            {% if request.resolver_match.url_name == 'dashboard' %}
                bg-dark
            {% elif request.resolver_match.url_name == 'requests_center' %}
                bg-warning
            {% elif request.resolver_match.url_name == 'workshops_list' %}
                bg-primary
            {% elif request.resolver_match.url_name == 'fire_stations_list' %}
                bg-danger
            {% elif request.resolver_match.url_name == 'spare_parts_list' %}
                bg-success
            {% elif request.resolver_match.url_name == 'suppliers_list' %}
                bg-info
            {% elif request.resolver_match.url_name == 'users_list' %}
                bg-dark
            {% else %}
                bg-primary
            {% endif %}">
    <div class="container-fluid">
        <a class="navbar-brand" href="{% url 'sigve:dashboard' %}">
            <i class="bi bi-fire"></i> SIGVE Admin
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            
            <!-- Menú Principal -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" 
                       href="{% url 'sigve:dashboard' %}">
                        <i class="bi bi-{% if request.resolver_match.url_name == 'dashboard' %}speedometer{% else %}speedometer2{% endif %}"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {% if request.resolver_match.url_name == 'requests_center' %}active{% endif %}" 
                       href="{% url 'sigve:requests_center' %}">
                        <i class="bi bi-{% if request.resolver_match.url_name == 'requests_center' %}inbox-fill{% else %}inbox{% endif %}"></i> Solicitudes
                    </a>
                </li>
                
                <!-- Dropdown Clientes -->
                {% with client_pages='workshops_list,fire_stations_list' %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle {% if request.resolver_match.url_name in client_pages %}active{% endif %}" 
                       href="#" id="clientsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-{% if request.resolver_match.url_name in client_pages %}building-fill{% else %}building{% endif %}"></i> Clientes
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item {% if request.resolver_match.url_name == 'workshops_list' %}active{% endif %}" 
                               href="{% url 'sigve:workshops_list' %}">
                               <i class="bi bi-wrench"></i> Talleres
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item {% if request.resolver_match.url_name == 'fire_stations_list' %}active{% endif %}" 
                               href="{% url 'sigve:fire_stations_list' %}">
                               <i class="bi bi-fire"></i> Cuarteles
                            </a>
                        </li>
                    </ul>
                </li>
                {% endwith %}

                <!-- Dropdown Catálogos -->
                {% with catalog_pages='spare_parts_list,suppliers_list,catalog_list' %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle {% if request.resolver_match.url_name in catalog_pages %}active{% endif %}" 
                       href="#" id="catalogsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-{% if request.resolver_match.url_name in catalog_pages %}box-seam-fill{% else %}box-seam{% endif %}"></i> Catálogos
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item {% if request.resolver_match.url_name == 'spare_parts_list' %}active{% endif %}" 
                               href="{% url 'sigve:spare_parts_list' %}">
                               <i class="bi bi-{% if request.resolver_match.url_name == 'spare_parts_list' %}gear-fill{% else %}gear{% endif %}"></i> Repuestos
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item {% if request.resolver_match.url_name == 'suppliers_list' %}active{% endif %}" 
                               href="{% url 'sigve:suppliers_list' %}">
                               <i class="bi bi-truck"></i> Proveedores
                            </a>
                        </li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">Tablas Lookup</h6></li>
                        
                        <!-- 
                          Para los catálogos, también comprobamos el 'model_name' 
                          pasado en la URL para un resaltado perfecto.
                        -->
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'vehicle_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'vehicle_type' %}">Tipos de Vehículo</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'vehicle_status' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'vehicle_status' %}">Estados de Vehículo</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'fuel_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'fuel_type' %}">Tipos de Combustible</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'transmission_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'transmission_type' %}">Tipos de Transmisión</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'oil_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'oil_type' %}">Tipos de Aceite</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'coolant_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'coolant_type' %}">Tipos de Refrigerante</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'task_type' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'task_type' %}">Tipos de Tarea</a></li>
                        <li><a class="dropdown-item {% if request.resolver_match.url_name == 'catalog_list' and request.resolver_match.kwargs.model_name == 'role' %}active{% endif %}" 
                               href="{% url 'sigve:catalog_list' 'role' %}">Roles</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <a class="dropdown-item {% if request.resolver_match.url_name == 'request_types_list' %}active{% endif %}" 
                               href="{% url 'sigve:request_types_list' %}">
                               <i class="bi bi-file-earmark-text"></i> Tipos de Solicitudes
                            </a>
                        </li>
                    </ul>
                </li>
                {% endwith %}

                <li class="nav-item">
                    <a class="nav-link {% if request.resolver_match.url_name == 'users_list' %}active{% endif %}" 
                       href="{% url 'sigve:users_list' %}">
                        <i class="bi bi-{% if request.resolver_match.url_name == 'users_list' %}people-fill{% else %}people{% endif %}"></i> Usuarios
                    </a>
                </li>
            </ul>
            
            <!-- Menú de Usuario (lado derecho) -->
            <ul class="navbar-nav ms-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle"></i> {{ request.session.sb_user_role|default:"Admin" }}
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="{% url 'logout' %}"><i class="bi bi-box-arrow-right"></i> Cerrar Sesión</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>