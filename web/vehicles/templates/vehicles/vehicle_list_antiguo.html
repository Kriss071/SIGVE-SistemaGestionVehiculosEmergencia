{% extends "base.html" %}
{% block title %}Veh칤culos{% endblock %}
{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/vehicles.css' %}">
{% endblock %}

{% block content %}
<main class="main-container">

    <!-- Listado de Veh칤culos -->
    <section class="vehicle-list" id="vehicleListContainer">

        <div class="vehicle-search-bar-container">
            <form class="vehicle-search-bar" method="get" id="vehicleSearchForm">
                <input type="text" name="q" id="vehicleSearchInput"
                    placeholder="Buscar veh칤culo por patente, marca, modelo o a침o...">
                <button type="submit">
                    游댌
                </button>
            </form>
        </div>

        <div id="vehicleLoader" class="vehicle-loader hidden">
            游댃 Buscando veh칤culos...
        </div>

        <div class="vehicle-list" id="vehicleList">
            {% for vehicle in vehicles %}

            <article class="vehicle-card" data-license-plate="{{ vehicle.license_plate }}">
                {% if vehicle.imagen_url %}
                <img src="{{ vehicle.imagen_url }}" class="vehicle-image"
                    alt="{{ vehicle.brand }} {{ vehicle.model }}">
                {% else %}
                <img src="{% static 'img/img_not_found.jpg' %}" class="vehicle-image" alt="Imagen no disponible">
                {% endif %}
                <div class="vehicle-info">
                    <h2 class="vehicle-title">{{ vehicle.license_plate }}</h2>
                    <p class="vehicle-description">{{ vehicle.brand }} - {{ vehicle.model }}</p>
                    <p class="vehicle-description">A침o: {{ vehicle.year }}</p>
                    {% if vehicle.vehicle_type_name %}
                    <p class="vehicle-description">{{ vehicle.vehicle_type_name }}</p>
                    {% endif %}
                    {% if vehicle.vehicle_status_name %}
                    <p class="vehicle-description">Estado: {{ vehicle.vehicle_status_name }}</p>
                    {% endif %}
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="vehicle-next-icon" viewBox="0 0 42 42">
                    <path fill="currentColor" fill-rule="evenodd"
                        d="M13.933 1L34 21.068L14.431 40.637l-4.933-4.933l14.638-14.636L9 5.933z" />
                </svg>
            </article>
            {% empty %}
            <li>No hay veh칤culos registrados.</li>
            {% endfor %}
        </div>

    </section>

    <!-- Botones -->
    <section class="vehicle-options">

        <p>
            Rol: <strong>{{ user_role|capfirst }}</strong>
        </p>
        {% if user_role == "Mec치nico" or user_role == "Administrador" %}
        <button class="vehicle-options-button">
            + Mantenci칩n
        </button>
        {% endif %}

        {% if user_role == "Administrador" %}
        <button class="vehicle-options-button" id="btnAddVehicle">
            + Veh칤culo
        </button>
        {% endif %}

    </section>
</main>

<!--  Formulario para ingresar Veh칤culos-->
{% include "modal/_vehicle_form.html" %}

<!-- Modal detalle vehiculo -->
{% include "modal/_vehicle_detail.html" %}

{% endblock %}

{% block scripts %}
<script src="{% static 'js/vehicles.js' %}"></script>
{% endblock %}